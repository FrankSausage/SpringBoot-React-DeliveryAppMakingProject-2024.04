{"version":3,"file":"place_utils.js","sourceRoot":"","sources":["../../src/utils/place_utils.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {html} from 'lit';\n\nimport {APILoader} from '../api_loader/api_loader.js';\n\nimport {extractTextAndURL} from './dom_utils.js';\nimport type {LatLng, LatLngLiteral, Place, PlaceResult, PriceLevel} from './googlemaps_types.js';\nimport {isOpen} from './opening_hours.js';\n\n/**\n * Returns true if `place` is a `PlaceResult`, and false if it's a `Place`.\n *\n * @param place - A `google.maps.places.Place` or\n *     `google.maps.places.PlaceResult`.\n */\nexport function isPlaceResult(place: Place|PlaceResult): place is PlaceResult {\n  // To avoid depending on loading the API at runtime, we do not use\n  // `instanceof google.map.places.Place`.\n  // TODO: fix for property renaming safety?\n  return !place.hasOwnProperty('id');\n}\n\n/**\n * Contains info that describes the origin or destination of a journey. This\n * interface is compatible with `google.maps.Place` and is suitable for use in\n * a request to the Directions or Distance Matrix services.\n */\nexport interface WaypointInfo {\n  location?: LatLngLiteral;\n  placeId?: string;\n  query?: string;\n}\n\n/** Creates a new `WaypointInfo` object based on input data. */\nexport function makeWaypoint(data: LatLng|LatLngLiteral|Place): WaypointInfo {\n  if (isPlace(data)) {\n    return {\n      location: data.location?.toJSON() ?? undefined,\n      placeId: data.id,\n      query: data.formattedAddress ?? data.displayName ?? undefined,\n    };\n  }\n  if (isLatLng(data)) {\n    return {location: data.toJSON()};\n  }\n  return {location: data};\n}\n\nfunction isPlace(data: LatLng|LatLngLiteral|Place): data is Place {\n  return data.hasOwnProperty('id');\n}\n\nfunction isLatLng(data: LatLng|LatLngLiteral): data is LatLng {\n  return typeof data.lat === 'function';\n}\n\nconst PRICE_LEVEL_CONVERSIONS: Record<PriceLevel, number> = Object.freeze({\n  'FREE': 0,\n  'INEXPENSIVE': 1,\n  'MODERATE': 2,\n  'EXPENSIVE': 3,\n  'VERY_EXPENSIVE': 4,\n});\n\nconst REVERSE_PRICE_LEVEL_CONVERSIONS: Record<number, PriceLevel> =\n    Object.freeze(Object.fromEntries(\n        Object.entries(PRICE_LEVEL_CONVERSIONS).map(tup => tup.reverse())));\n\n/**\n * Converts an enum price level to the corresponding numeric value. If passed a\n * numeric value, it will return it unchanged.\n */\nexport function priceLevelToNumeric(level: number|PriceLevel): number|null {\n  if (typeof level === 'number') return level;\n  return PRICE_LEVEL_CONVERSIONS[level] ?? null;\n}\n\n/**\n * Converts a numeric price level to the corresponding enum value. If passed an\n * enum value, it will return it unchanged.\n */\nexport function numericToPriceLevel(level: number|PriceLevel): PriceLevel|null {\n  if (typeof level !== 'number') return level;\n  return REVERSE_PRICE_LEVEL_CONVERSIONS[level] ?? null;\n}\n\n/**\n * Renders attribution data returned by the Places API as either an `<a>` or a\n * `<span>` depending on the presence of the URL field.\n *\n * @param text Name of the author or provider.\n * @param url URL that links to the author or provider page.\n */\nexport function renderAttribution(text: string, url: string|null) {\n  return url ? html`<a href=${url} target=\"_blank\">${text}</a>` :\n               html`<span>${text}</span>`;\n}\n\n/**\n * Creates a new `Place` object that sources its property values from\n * equivalent fields in the `PlaceResult` object, if they are defined.\n */\nexport async function makePlaceFromPlaceResult(\n    placeResult: PlaceResult, consumer?: HTMLElement): Promise<Place> {\n  const placesLibrary = await APILoader.importLibrary('places', consumer) as\n      typeof google.maps.places;\n  const place = new placesLibrary.Place(\n                    {id: placeResult.place_id ?? 'PLACE_ID_MISSING'}) as Place;\n  let predefinedFields = convertToPlaceFields(placeResult);\n\n  // Override Place object's getters to return data from PlaceResult if defined.\n  return new Proxy(place, {\n    get(target, name, receiver) {\n      // Intercept calls to the `fetchFields()` method and filter out any field\n      // names in the request that already have values derived from PlaceResult.\n      if (name === 'fetchFields') {\n        return async (request: google.maps.places.FetchFieldsRequest) => {\n          const requestFields = request.fields as [keyof Place];\n          const forwardedFields = requestFields.filter(\n              (field) => predefinedFields[field] === undefined);\n          try {\n            return await target.fetchFields(\n                {...request, fields: forwardedFields});\n          } catch (e: unknown) {\n            // Place.fetchFields() is only available in beta versions of the\n            // Maps JS SDK. If a stable version of the SDK is loaded, fall\n            // back to the Place Details API.\n            if (isNotAvailableError(e, 'fetchFields()')) {\n              const placeResultFields =\n                  mapPlaceFieldsToPlaceResultFields(forwardedFields);\n              if (!placeResultFields.length) return {place};\n              const response = await fetchFromPlaceDetails(\n                  placesLibrary, place.id, placeResultFields);\n              predefinedFields = {\n                ...convertToPlaceFields(response),\n                ...predefinedFields,\n              };\n              return {place};\n            }\n            throw e;\n          }\n        };\n      } else if (name === 'isOpen') {\n        return async (d?: Date) => {\n          try {\n            // Must redirect the original isOpen() method's `this` to point to\n            // the proxy object.\n            return await Reflect.get(target, name, receiver).apply(receiver, [\n              d\n            ]);\n          } catch (e: unknown) {\n            if (isNotAvailableError(e, 'isOpen()')) return isOpen(receiver, d);\n            throw e;\n          }\n        };\n      }\n      const value = predefinedFields[name as keyof Place];\n      return value === undefined ? Reflect.get(target, name, receiver) : value;\n    }\n  });\n}\n\n/**\n * Determines whether the current Place object has enough data to evaluate\n * `isOpen()` or `getNextOpeningTime()` without making additional fetches.\n */\nexport function hasDataForOpeningCalculations(place: Place): boolean {\n  return !!(\n      place.businessStatus && place.regularOpeningHours &&\n      (place.utcOffsetMinutes != null));\n}\n\n/** Converts `PlaceResult` data to `Place`-compatible field values. */\nfunction convertToPlaceFields(placeResult: PlaceResult): Partial<Place> {\n  const place: Partial<Place> = {};\n  if (placeResult.address_components !== undefined) {\n    place.addressComponents = placeResult.address_components.map(\n        (component: google.maps.GeocoderAddressComponent) => ({\n          longText: component.long_name,\n          shortText: component.short_name,\n          types: component.types,\n        }));\n  }\n  if (placeResult.adr_address !== undefined) {\n    place.adrFormatAddress = placeResult.adr_address;\n  }\n  if (placeResult.business_status !== undefined) {\n    place.businessStatus = placeResult.business_status;\n  }\n  if (placeResult.formatted_address !== undefined) {\n    place.formattedAddress = placeResult.formatted_address;\n  }\n  if (placeResult.formatted_phone_number !== undefined) {\n    place.nationalPhoneNumber = placeResult.formatted_phone_number;\n  }\n  if (placeResult.geometry !== undefined) {\n    const geometry = placeResult.geometry;\n    if (geometry.location) place.location = geometry.location;\n    if (geometry.viewport) place.viewport = geometry.viewport;\n  }\n  if (placeResult.html_attributions !== undefined) {\n    place.attributions = placeResult.html_attributions.map((html: string) => {\n      const {text, url} = extractTextAndURL(html);\n      return {provider: text ?? '', providerURI: url ?? null};\n    });\n  }\n  if (placeResult.icon_background_color !== undefined) {\n    place.iconBackgroundColor = placeResult.icon_background_color;\n  }\n  if (placeResult.icon_mask_base_uri !== undefined) {\n    place.svgIconMaskURI = placeResult.icon_mask_base_uri;\n  }\n  if (placeResult.international_phone_number !== undefined) {\n    place.internationalPhoneNumber = placeResult.international_phone_number;\n  }\n  if (placeResult.name !== undefined) {\n    place.displayName = placeResult.name;\n  }\n  if (placeResult.opening_hours !== undefined) {\n    const periods = placeResult.opening_hours.periods?.map(\n        (period: google.maps.places.PlaceOpeningHoursPeriod) => ({\n          open: makeOpeningHoursPoint(period.open),\n          // A place that is open 24/7 does not return a close period.\n          close: period.close ? makeOpeningHoursPoint(period.close) : null,\n        }));\n    place.regularOpeningHours = {\n      periods: periods ?? [],\n      weekdayDescriptions: placeResult.opening_hours.weekday_text ?? [],\n    };\n  }\n  if (placeResult.photos !== undefined) {\n    place.photos =\n        placeResult.photos.map((photo: google.maps.places.PlacePhoto) => {\n          const attributions = photo.html_attributions.map((html) => {\n            const {text, url} = extractTextAndURL(html);\n            return {displayName: text ?? '', photoURI: '', uri: url || ''};\n          });\n          return {\n            authorAttributions: attributions,\n            getURI: photo.getUrl,\n            heightPx: photo.height,\n            widthPx: photo.width,\n          };\n        });\n  }\n  if (placeResult.place_id !== undefined) {\n    place.id = placeResult.place_id;\n  }\n  if (placeResult.plus_code !== undefined) {\n    place.plusCode = {\n      compoundCode: placeResult.plus_code.compound_code ?? null,\n      globalCode: placeResult.plus_code.global_code,\n    };\n  }\n  if (placeResult.price_level !== undefined) {\n    place.priceLevel = numericToPriceLevel(placeResult.price_level);\n  }\n  if (placeResult.rating !== undefined) {\n    place.rating = placeResult.rating;\n  }\n  if (placeResult.reviews !== undefined) {\n    place.reviews = placeResult.reviews.map(\n        (review: google.maps.places.PlaceReview) => ({\n          authorAttribution: {\n            displayName: review.author_name,\n            photoURI: review.profile_photo_url,\n            uri: review.author_url || '',\n          },\n          // Convert publish time from milliseconds to a Date object.\n          publishTime: new Date(review.time),\n          rating: review.rating ?? null,\n          relativePublishTimeDescription: review.relative_time_description,\n          text: review.text,\n          textLanguageCode: review.language,\n        }));\n  }\n  if (placeResult.types !== undefined) {\n    place.types = placeResult.types;\n  }\n  if (placeResult.url !== undefined) {\n    place.googleMapsURI = placeResult.url;\n  }\n  if (placeResult.user_ratings_total !== undefined) {\n    place.userRatingCount = placeResult.user_ratings_total;\n  }\n  if (placeResult.utc_offset_minutes !== undefined) {\n    place.utcOffsetMinutes = placeResult.utc_offset_minutes;\n  }\n  if (placeResult.website !== undefined) {\n    place.websiteURI = placeResult.website;\n  }\n  return place;\n}\n\n/**\n * Creates a `OpeningHoursPoint` object, and extracts `hours` and `minutes`\n * from the `time` property.\n */\nfunction makeOpeningHoursPoint(\n    {day, hours, minutes}: google.maps.places.PlaceOpeningHoursTime):\n    google.maps.places.OpeningHoursPoint {\n  return {day, hour: hours, minute: minutes};\n}\n\nconst PLACE_TO_PLACE_RESULT_FIELDS:\n    Partial<Record<keyof Place, keyof PlaceResult>> = {\n      'addressComponents': 'address_components',\n      'adrFormatAddress': 'adr_address',\n      'businessStatus': 'business_status',\n      'formattedAddress': 'formatted_address',\n      'nationalPhoneNumber': 'formatted_phone_number',\n      'location': 'geometry',\n      'viewport': 'geometry',\n      'iconBackgroundColor': 'icon_background_color',\n      'svgIconMaskURI': 'icon_mask_base_uri',\n      'internationalPhoneNumber': 'international_phone_number',\n      'displayName': 'name',\n      'regularOpeningHours': 'opening_hours',\n      'photos': 'photos',\n      'plusCode': 'plus_code',\n      'priceLevel': 'price_level',\n      'rating': 'rating',\n      'reviews': 'reviews',\n      'types': 'types',\n      'googleMapsURI': 'url',\n      'userRatingCount': 'user_ratings_total',\n      'utcOffsetMinutes': 'utc_offset_minutes',\n      'websiteURI': 'website',\n      'id': 'place_id'\n    };\n\n/** Maps a list of Place field names to equivalent PlaceResult field names. */\nexport function mapPlaceFieldsToPlaceResultFields(fields: Array<keyof Place>):\n    Array<keyof PlaceResult> {\n  const placeResultFields: Array<keyof PlaceResult> = [];\n  for (const placeField of fields) {\n    const mapped = PLACE_TO_PLACE_RESULT_FIELDS[placeField];\n    if (mapped) placeResultFields.push(mapped);\n  }\n  return placeResultFields;\n}\n\n/**\n * Determines if the error results from a specified property not being\n * available on the Place class (or an instance of that class).\n */\nexport function isNotAvailableError(e: unknown, property: string): e is Error {\n  if (!(e instanceof Error)) return false;\n  return e.message.startsWith(`Place.prototype.${property} is not available`) ||\n      e.message.startsWith(\n          `google.maps.places.Place.${property} is not available`);\n}\n\nasync function fetchFromPlaceDetails(\n    placesLibrary: typeof google.maps.places, placeId: string,\n    fields: string[]): Promise<PlaceResult> {\n  const placesService =\n      new placesLibrary.PlacesService(document.createElement('div'));\n  return new Promise((resolve, reject) => {\n    placesService.getDetails({placeId, fields}, (result, status) => {\n      if (result && status === 'OK') {\n        resolve(result);\n      } else {\n        reject(status);\n      }\n    });\n  });\n}"]}