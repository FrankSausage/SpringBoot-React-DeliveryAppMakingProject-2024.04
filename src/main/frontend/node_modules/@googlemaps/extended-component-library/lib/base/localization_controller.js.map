{"version":3,"file":"localization_controller.js","sourceRoot":"","sources":["../../src/base/localization_controller.ts"],"names":[],"mappings":"AAAA;;;;GAIG;AAIH,OAAO,EAAC,qBAAqB,EAAiC,MAAM,cAAc,CAAC;AAKnF;;;GAGG;AACH,MAAM,OAAO,sBAAsB;IAIjC,YAA6B,IAAuC;QAAvC,SAAI,GAAJ,IAAI,CAAmC;QAClE,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;IAC3B,CAAC;IAED,aAAa;QACX,sBAAsB,CAAC,mBAAmB,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC5D,CAAC;IAED,gBAAgB;QACd,sBAAsB,CAAC,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAC/D,CAAC;IAED;;;;;OAKG;IACH,gBAAgB,CACZ,EAAK,EAAE,GAAG,IAA0C;QACtD,MAAM,OAAO,GAAG,sBAAsB,CAAC,wBAAwB,CAAC,EAAE,CAAC;YAC/D,qBAAqB,CAAC,EAAE,CAAC,CAAC;QAC9B,OAAO,CAAC,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,CAAC;IACpE,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,iBAAiB,CAAC,cAAuC;QAC9D,KAAK,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE;YAC7C,sBAAsB,CAAC,wBAAwB,CAAC,GAAG,CAAC;gBAChD,cAAc,CAAC,GAAG,CAAC,CAAC;SACzB;QACD,KAAK,MAAM,SAAS,IAAI,sBAAsB,CAAC,mBAAmB,EAAE;YAClE,SAAS,CAAC,aAAa,EAAE,CAAC;SAC3B;IACH,CAAC;IAED;;;OAGG;IACH,MAAM,CAAC,cAAc,CAAC,aAAyB;QAC7C,MAAM,SAAS,GAAG,IAAI,sBAAsB,CAAC,aAAa,CAAC,CAAC;QAC5D,OAAO,SAAS,CAAC,gBAAgB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACpD,CAAC;IAED;;;;;OAKG;IACH,MAAM,CAAC,KAAK;QACV,sBAAsB,CAAC,mBAAmB,CAAC,KAAK,EAAE,CAAC;QACnD,sBAAsB,CAAC,wBAAwB,GAAG,EAAE,CAAC;IACvD,CAAC;;AA5DuB,0CAAmB,GAAG,IAAI,GAAG,EAAmB,CAAC;AAC1D,+CAAwB,GAA4B,EAAE,CAAC","sourcesContent":["/**\n * @license\n * Copyright 2023 Google LLC\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {LitElement, ReactiveController, ReactiveControllerHost, ReactiveElement} from 'lit';\n\nimport {STRING_LITERALS_EN_US, StringFunction, StringLiterals} from './strings.js';\n\ntype ParametersOrEmpty<T extends string|StringFunction> =\n    T extends StringFunction ? Parameters<T>: [];\n\n/**\n * Controller that provides localized string literals (`en-US` by default)\n * for use in components of this library.\n */\nexport class LocalizationController implements ReactiveController {\n  private static readonly connectedComponents = new Set<ReactiveElement>();\n  private static translatedStringLiterals: Partial<StringLiterals> = {};\n\n  constructor(private readonly host: ReactiveControllerHost&LitElement) {\n    host.addController(this);\n  }\n\n  hostConnected() {\n    LocalizationController.connectedComponents.add(this.host);\n  }\n\n  hostDisconnected() {\n    LocalizationController.connectedComponents.delete(this.host);\n  }\n\n  /**\n   * Returns a localized string literal with the specified ID.\n   *\n   * @param args If the value keyed by that ID is a string function, provide\n   * one or more inputs as function arguments.\n   */\n  getStringLiteral<T extends keyof StringLiterals>(\n      id: T, ...args: ParametersOrEmpty<StringLiterals[T]>): string {\n    const literal = LocalizationController.translatedStringLiterals[id] ??\n        STRING_LITERALS_EN_US[id];\n    return (typeof literal === 'string') ? literal : literal(...args);\n  }\n\n  /**\n   * Sets one or many localized string literals in the new locale then\n   * requests an update for all currently connected components.\n   */\n  static setStringLiterals(stringLiterals: Partial<StringLiterals>) {\n    for (const key of Object.keys(stringLiterals)) {\n      LocalizationController.translatedStringLiterals[key] =\n          stringLiterals[key];\n    }\n    for (const component of LocalizationController.connectedComponents) {\n      component.requestUpdate();\n    }\n  }\n\n  /**\n   * Builds instance of localizer controller to be used for getting string\n   * literal messages.\n   */\n  static buildLocalizer(baseComponent: LitElement) {\n    const localizer = new LocalizationController(baseComponent);\n    return localizer.getStringLiteral.bind(localizer);\n  }\n\n  /**\n   * Resets Localization Controller state by clearing its connected components\n   * and translated string literals. This method should be invoked for testing\n   * purposes only.\n   * @ignore\n   */\n  static reset() {\n    LocalizationController.connectedComponents.clear();\n    LocalizationController.translatedStringLiterals = {};\n  }\n}\n"]}